<!DOCTYPE html>
<meta charset="utf-8">
<title>Histogram and Kernel Density Plot</title>
<style>

    <!-- based on http://bl.ocks.org/mbostock/4341954 -->
    body {
        font: 10px sans-serif;
    }

    .bar {
        fill: #bbb;
        shape-rendering: crispEdges;
    }

    .line {
        fill: none;
        stroke: #000;
        stroke-width: 1.5px;
    }

    .axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
        font-size: 3px;
    }

</style>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<body>
    <button class="w3-button w3-ripple w3-khaki" onclick="step1();">Step1: Input</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step2();">Step2: Histogram</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step3();">Step3: KDE</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step4();">Step4: Split</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step5_();">Step5: Gaussian (Normal)</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step6();">Step6: Calculate Log-Likelihood</button>
    <button class="w3-button w3-ripple w3-khaki" onclick="step7();">Step7: Final (MLE)</button>



    <div id="div_slider" class="slidecontainer" style="visibility:hidden;">

        <!--<button id="button_animation" onclick="butto_animation_click();">Animation</button>
        <br />
        <button id="test" onclick="move_points();">Test</button>
        <br />
        <button id="test2" onclick="gmm();">Test2</button>-->
        <p>
            KDE Bandwidth: <span id="demo"></span>
            <input type="range" min="1" max="10000" value="5000" class="slider" id="myRange">
        </p>
    </div>

    <div class="w3-cell-row">
        <div id="left" class="w3-cell">

        </div>
        <div id="right" class="w3-cell" style="visibility:hidden">

        </div>
    </div>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jstat/latest/jstat.min.js"></script>
    <script>

        // USER DEFINABLE VARIABLES START

        var numHistBins = 10; // number of bins for the histogram
        var calcHistBinsAutmoatic = true; // if true, the number of bins are calculated automatically and
        // numHistBins is overwritten
        var showKDP = true; // show the kernel density plot?
        var bandwith = 4; // bandwith (smoothing constant) h of the kernel density estimator
        var dataFN = "./faithful.json"; // the filename of the data to be visualized


        // USER DEFINABLE VARIABLES END


        var margin = { top: 20, right: 30, bottom: 60, left: 40 },
            width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

        // the x-scale parameters
        var x = d3.scale.linear()
            .domain([10000, 100000])
            .range([0, width]);

        var x_ = d3.scale.linear()
            .domain([0, width])
            .range([10000, 100000]);

        // the y-scale parameters
        var y = d3.scale.linear()
            .domain([0, .15])
            .range([height, 0]);

        var x2 = d3.scale.linear()
            .domain([30000, 50000])
            .range([0, 500]);

        var y2 = d3.scale.linear()
            .domain([75000, 55000])
            .range([0, height]);

        var x3 = d3.scale.linear()
            .domain([0, 100])
            .range([0, 500]);

        var y3 = d3.scale.linear()
            .domain([-41000, -43000])
            .range([0, 300]);

        var color_logsum = d3.scale.linear()
            .domain([-42000, -41000])
            .range(["blue", "red"]);

        var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom");

        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("left")
            .tickFormat(d3.format("%"));

        var xAxis2 = d3.svg.axis()
            .scale(x2)
            .orient("bottom");

        var yAxis2 = d3.svg.axis()
            .scale(y2)
            .orient("left");

        var xAxis3 = d3.svg.axis()
            .scale(x3)
            .orient("bottom");

        var yAxis3 = d3.svg.axis()
            .scale(y3)
            .orient("left");

        var line_ = d3.svg.line()
            .x(function (d) { return x(d[0]); })
            .y(function (d) { return y(0); });

        var line = d3.svg.line()
            .x(function (d) { return x(d[0]); })
            .y(function (d) { return y(d[1] * 800); });

        var line_kde = d3.svg.line()
            .x(function (d) { return x(d[0]); })
            .y(function (d) { return y(d[1] * 1600); });


        var line_log_sum_ = d3.svg.line()
            .x(function (d, i) { return x3(i); })
            .y(function (d, i) { return y3(-60); });

        var line_log_sum = d3.svg.line()
            .x(function (d, i) { return x3(i); })
            .y(function (d, i) { return y3(d); });


        //var input_data = [340, 380, 480, 500, 700, 740, 510, 550, 580, 880, 910];

        //var input_data = [19401, 22046, 22487, 22928, 24251, 24912, 24912, 25353, 25574, 25574, 25574, 25794, 25794, 26015, 26015, 26015, 26235, 26235, 26235, 26235, 26455, 26455, 26455, 26455, 26676, 26676, 26676, 26676, 26896, 26896, 26896, 26896, 27117, 27337, 27337, 27558, 27558, 27558, 27778, 27778, 27778, 27999, 27999, 27999, 27999, 27999, 27999, 27999, 28219, 28219, 28219, 28219, 28219, 28440, 28440, 28440, 28440, 28440, 28660, 28660, 28660, 28660, 28660, 28660, 28660, 28881, 28881, 28881, 28881, 28881, 28881, 28881, 29101, 29101, 29101, 29101, 29101, 29101, 29101, 29321, 29321, 29321, 29321, 29321, 29542, 29542, 29542, 29542, 29542, 29542, 29542, 29542, 29542, 29542, 29542, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29762, 29983, 29983, 29983, 29983, 29983, 29983, 29983, 29983, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30424, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30644, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 30865, 31085, 31085, 31085, 31085, 31085, 31085, 31085, 31085, 31085, 31085, 31085, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31306, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31747, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 31967, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32408, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 32849, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33290, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33731, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34172, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34613, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 34833, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35053, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35274, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35494, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35715, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 35935, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36156, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36376, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36597, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 36817, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37038, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37258, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37479, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37699, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 37919, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38140, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38360, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38581, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 38801, 39022, 39022, 39022, 39022, 39022, 39022, 39022, 39022, 39022, 39022, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39242, 39463, 39463, 39463, 39463, 39463, 39463, 39463, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39683, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 39904, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40124, 40345, 40345, 40345, 40345, 40345, 40345, 40345, 40345, 40345, 40345, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40565, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 40785, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41006, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41226, 41447, 41447, 41447, 41447, 41447, 41447, 41447, 41447, 41447, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41667, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 41888, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42108, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42329, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42549, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42770, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 42990, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43211, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43431, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43651, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 43872, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44092, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44313, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44754, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 44974, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45195, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45415, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45636, 45856, 45856, 45856, 45856, 45856, 45856, 45856, 45856, 45856, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46077, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46297, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46517, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46738, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 46958, 47179, 47179, 47179, 47179, 47179, 47179, 47179, 47179, 47179, 47179, 47179, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47399, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47620, 47840, 47840, 47840, 47840, 47840, 47840, 47840, 47840, 47840, 47840, 47840, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48061, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48502, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48722, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 48943, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49163, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49383, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49604, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 49824, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50045, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50265, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50486, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50706, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 50927, 51147, 51147, 51147, 51147, 51147, 51147, 51147, 51147, 51147, 51147, 51147, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51368, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51588, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 51809, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52029, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52249, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52470, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52690, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 52911, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53131, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53352, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53572, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 53793, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54013, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54234, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54454, 54675, 54675, 54675, 54675, 54675, 54675, 54675, 54895, 54895, 54895, 54895, 54895, 54895, 54895, 54895, 54895, 54895, 54895, 55116, 55116, 55116, 55116, 55116, 55116, 55116, 55116, 55116, 55116, 55116, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55336, 55556, 55556, 55556, 55556, 55556, 55556, 55556, 55556, 55556, 55556, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55777, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 55997, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56218, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56438, 56659, 56659, 56659, 56659, 56659, 56659, 56659, 56659, 56659, 56659, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 56879, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57100, 57320, 57320, 57320, 57320, 57320, 57320, 57320, 57320, 57320, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57541, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57761, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 57982, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58202, 58422, 58422, 58422, 58422, 58422, 58422, 58422, 58422, 58422, 58422, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58643, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 58863, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59084, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59304, 59525, 59525, 59525, 59525, 59525, 59525, 59745, 59745, 59745, 59745, 59745, 59745, 59745, 59966, 59966, 59966, 59966, 59966, 59966, 59966, 59966, 59966, 59966, 60186, 60186, 60186, 60186, 60186, 60186, 60186, 60186, 60186, 60407, 60407, 60407, 60407, 60407, 60407, 60407, 60407, 60407, 60407, 60407, 60627, 60627, 60627, 60627, 60627, 60627, 60627, 60627, 60627, 60627, 60848, 60848, 60848, 60848, 60848, 60848, 60848, 61068, 61068, 61068, 61068, 61068, 61068, 61068, 61068, 61068, 61068, 61068, 61288, 61288, 61288, 61288, 61288, 61288, 61288, 61288, 61288, 61288, 61288, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61509, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61729, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 61950, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62170, 62391, 62391, 62391, 62391, 62391, 62391, 62391, 62391, 62391, 62391, 62391, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62611, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 62832, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63052, 63273, 63273, 63273, 63273, 63273, 63273, 63273, 63273, 63273, 63493, 63493, 63493, 63493, 63493, 63493, 63493, 63493, 63714, 63714, 63714, 63714, 63714, 63714, 63714, 63714, 63714, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 63934, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64154, 64375, 64375, 64375, 64375, 64375, 64375, 64375, 64375, 64375, 64375, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64595, 64816, 64816, 64816, 64816, 64816, 64816, 64816, 64816, 64816, 64816, 64816, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65036, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65257, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65477, 65698, 65698, 65698, 65698, 65698, 65698, 65918, 65918, 65918, 65918, 65918, 65918, 65918, 65918, 65918, 65918, 65918, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66139, 66359, 66359, 66359, 66359, 66359, 66359, 66359, 66359, 66359, 66359, 66359, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66580, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 66800, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67020, 67241, 67241, 67241, 67241, 67241, 67241, 67241, 67241, 67241, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67461, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67682, 67902, 67902, 67902, 67902, 67902, 67902, 67902, 67902, 67902, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68123, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68343, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68564, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 68784, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69005, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69225, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69446, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69666, 69886, 69886, 69886, 69886, 69886, 69886, 69886, 69886, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70107, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70327, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70548, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70768, 70989, 70989, 70989, 70989, 70989, 70989, 70989, 70989, 70989, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71209, 71430, 71430, 71430, 71430, 71430, 71430, 71430, 71430, 71430, 71430, 71430, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71650, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 71871, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72091, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72312, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72532, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72752, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 72973, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73193, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73414, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73634, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 73855, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74075, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74296, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74516, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74737, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 74957, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75178, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75398, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 75839, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76280, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76500, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76721, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77162, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77603, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78044, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78264, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78484, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78705, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 79146, 79146, 79146, 79146, 79146, 79146, 79146, 79146, 79146, 79146, 79146, 79366, 79366, 79366, 79366, 79366, 79366, 79366, 79587, 79587, 79587, 79587, 79587, 79807, 79807, 79807, 79807, 79807, 79807, 79807, 80028, 80028, 80028, 80248, 80248, 80248, 80248, 80248, 80248, 80469, 80469, 80689, 80689, 80910, 80910, 80910, 81130, 81130, 81130, 81350, 81350, 81571, 81571, 82232, 82232, 82232, 82453, 82673, 83776, 84657, 87082, 90389, 93476, 108467, 116183];
        var input_data = [20723, 21164, 22046, 23148, 23148, 23809, 24030, 24030, 24250, 24471, 24471, 24471, 24471, 24912, 24912, 24912, 25132, 25353, 25353, 25573, 25573, 25794, 25794, 25794, 26014, 26014, 26014, 26234, 26234, 26234, 26234, 26234, 26455, 26455, 26455, 26675, 26675, 26896, 26896, 26896, 26896, 27116, 27116, 27337, 27337, 27337, 27337, 27557, 27557, 27557, 27778, 27778, 27778, 27778, 27998, 27998, 27998, 28219, 28219, 28219, 28219, 28219, 28219, 28439, 28439, 28439, 28439, 28439, 28660, 28660, 28660, 28660, 28660, 28880, 28880, 28880, 28880, 28880, 29100, 29100, 29100, 29100, 29100, 29321, 29321, 29321, 29321, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29541, 29762, 29762, 29762, 29762, 29762, 29982, 29982, 29982, 29982, 29982, 29982, 29982, 29982, 29982, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30203, 30423, 30423, 30423, 30423, 30423, 30644, 30644, 30644, 30644, 30644, 30644, 30864, 30864, 30864, 30864, 30864, 30864, 30864, 30864, 30864, 30864, 31085, 31085, 31085, 31085, 31085, 31085, 31305, 31305, 31305, 31305, 31305, 31305, 31305, 31305, 31305, 31305, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31526, 31746, 31746, 31746, 31746, 31746, 31746, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 31966, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32187, 32407, 32407, 32407, 32407, 32407, 32407, 32407, 32407, 32407, 32407, 32407, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32628, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 32848, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33069, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33289, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33510, 33730, 33730, 33730, 33730, 33730, 33730, 33730, 33730, 33730, 33730, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 33951, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34171, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34392, 34612, 34612, 34612, 34612, 34612, 34612, 34612, 34612, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 34832, 35053, 35053, 35053, 35053, 35053, 35053, 35273, 35273, 35273, 35273, 35273, 35273, 35273, 35273, 35494, 35494, 35494, 35494, 35714, 35714, 35714, 35714, 35714, 35935, 35935, 35935, 36155, 36155, 36155, 36376, 36376, 36376, 36376, 36376, 36376, 36596, 36817, 36817, 36817, 36817, 37037, 37037, 37037, 37037, 37037, 37037, 37258, 37258, 37258, 37258, 37478, 37478, 37478, 37478, 37478, 37699, 37699, 37699, 37699, 37919, 37919, 37919, 37919, 38139, 38139, 38360, 38360, 38360, 38360, 38580, 38580, 38801, 38801, 38801, 38801, 38801, 39021, 39242, 39242, 39242, 39242, 39242, 39242, 39462, 39683, 39683, 39903, 39903, 39903, 39903, 39903, 40124, 40344, 40344, 40344, 40344, 40565, 40565, 40565, 40565, 40565, 40785, 41005, 41005, 41005, 41226, 41226, 41667, 41667, 41887, 41887, 42108, 42108, 42328, 42328, 42328, 42328, 42549, 42549, 42769, 42990, 42990, 43210, 43210, 43431, 43431, 43431, 43651, 43651, 43651, 43651, 43651, 43871, 43871, 43871, 43871, 44092, 44312, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44533, 44753, 44753, 44974, 44974, 44974, 44974, 44974, 44974, 45194, 45194, 45194, 45415, 45635, 45856, 45856, 45856, 46076, 46076, 46076, 46076, 46076, 46297, 46297, 46517, 46737, 46737, 46737, 46737, 46958, 46958, 47178, 47399, 47619, 47619, 47619, 47619, 47619, 47840, 48060, 48060, 48060, 48060, 48281, 48281, 48281, 48281, 48281, 48281, 48281, 48501, 48501, 48501, 48722, 48942, 49163, 49383, 49383, 49824, 50044, 50044, 50265, 50265, 50265, 50485, 50485, 50706, 50706, 50706, 50926, 50926, 51147, 51147, 51367, 51808, 51808, 51808, 51808, 51808, 52029, 52029, 52029, 52249, 52469, 52690, 52690, 52910, 52910, 52910, 53131, 53131, 54013, 54013, 54233, 55115, 55115, 55335, 55776, 55776, 55776, 55776, 55776, 55997, 56658, 56879, 56879, 57099, 57540, 57761, 57761, 57761, 57981, 57981, 57981, 58201, 58422, 58642, 58642, 59083, 59083, 59083, 59083, 59304, 59304, 59524, 59745, 59745, 59965, 60186, 60186, 60186, 60406, 60406, 60406, 60406, 61067, 61067, 61067, 61288, 61508, 61729, 62170, 62390, 62611, 62611, 62831, 63052, 63052, 63052, 63493, 63713, 63713, 63933, 63933, 64154, 64154, 65036, 65036, 65256, 65477, 65697, 65697, 65918, 65918, 65918, 66138, 66579, 67020, 67240, 67240, 67461, 67461, 67681, 68122, 68343, 68343, 68563, 68563, 68784, 68784, 69004, 69004, 69225, 69225, 69445, 69445, 69665, 69665, 69665, 69665, 69886, 69886, 69886, 69886, 70106, 70106, 70106, 70327, 70327, 70547, 70547, 70547, 70547, 70547, 70768, 70768, 70768, 70988, 71209, 71209, 71429, 71429, 71429, 71429, 71429, 71650, 71650, 71650, 71650, 71650, 71870, 71870, 71870, 71870, 72091, 72091, 72091, 72091, 72091, 72091, 72311, 72311, 72531, 72531, 72531, 72531, 72752, 72752, 72752, 72752, 72972, 72972, 72972, 72972, 72972, 73193, 73193, 73413, 73413, 73413, 73413, 73413, 73413, 73413, 73413, 73634, 73634, 73634, 73634, 73634, 73854, 73854, 73854, 73854, 73854, 73854, 74075, 74075, 74075, 74295, 74295, 74295, 74295, 74516, 74516, 74516, 74516, 74736, 74736, 74736, 74736, 74736, 74736, 74736, 74957, 74957, 74957, 74957, 75177, 75177, 75177, 75177, 75177, 75177, 75177, 75398, 75398, 75398, 75398, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75618, 75838, 75838, 75838, 75838, 75838, 75838, 75838, 75838, 75838, 75838, 75838, 76059, 76059, 76059, 76059, 76059, 76059, 76059, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76279, 76500, 76500, 76500, 76500, 76500, 76500, 76720, 76720, 76720, 76720, 76720, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 76941, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77161, 77382, 77382, 77382, 77382, 77382, 77382, 77382, 77602, 77602, 77602, 77602, 77602, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 77823, 78043, 78043, 78043, 78043, 78043, 78043, 78043, 78043, 78264, 78264, 78264, 78484, 78484, 78484, 78704, 78704, 78704, 78704, 78704, 78704, 78704, 78704, 78704, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 78925, 79145, 79145, 79145, 79145, 79145, 79145, 79366, 79366, 79366, 79366, 79366, 79366, 79586, 79586, 79586, 79586, 79807, 79807, 79807, 80027, 80027, 80027, 80027, 80027, 80027, 80027, 80027, 80027, 80248, 80248, 80248, 80248, 80248, 80468, 80468, 80468, 80689, 80689, 80689, 80689, 80689, 80909, 80909, 80909, 81130, 81350, 81350, 81350, 81570, 81570, 81570, 81791, 81791, 82011, 82011, 82011, 82232, 82232, 82452, 82452, 82452, 82673, 82673, 83114, 83114, 83114, 83114, 83555, 83775, 83775, 83996, 84216, 84216, 84657, 85098, 85980, 90830, 91932, 96121];
        //var histogram_data = [300, 350, 450, 500, 700, 700, 500, 550, 550, 850, 900];
        var histogram_data = [];
        input_data.forEach(function (d) {
            histogram_data.push(Math.round(d / 1000) * 1000);
        });
        //console.log("histogram_data", histogram_data);


        var svg1 = d3.select("#left").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // draw the background
        //svg1.append("g")
        //    .attr("class", "x axis xaxis1")
        //    .attr("transform", "translate(0," + 0 + ")")
        //    .call(xAxis)
        //    .append("text")
        //    .attr("class", "label")
        //    .attr("x", width)
        //    .attr("y", 40)
        //    .style("text-anchor", "end")
        //    .text("Total Gross Weight (lbs)");


        var svg2 = d3.select("#right").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + 300 + "," + margin.top + ")");

        // draw the background
        svg2.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis2)
            .attr("font-size", 10)
            .append("text")
            .attr("class", "label")
            .attr("x", 500)
            .attr("y", -6)
            .style("text-anchor", "end")
            .text("Cut-off 1");

        svg2.append("g")
            .attr("class", "y axis")
            .attr("transform", "translate(0," + 0 + ")")
            .call(yAxis2)
            .attr("font-size", 10)
            .append("text")
            .attr("class", "label")
            .attr("x", 30)
            .attr("y", -6)
            .style("text-anchor", "end")
            .text("Cut-off 2");


        var svg3 = d3.select("#right").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + 300 + "," + margin.top + ")");

        // draw the background
        //svg3.append("g")
        //    .attr("class", "x axis")
        //    .attr("transform", "translate(0," + 200 + ")")
        //    .call(xAxis3)
        //    .append("text")
        //    .attr("class", "label")
        //    .attr("x", 500)
        //    .attr("y", -6)
        //    .style("text-anchor", "end")
        //    .text("Cut-off 1");

        svg3.append("g")
            .attr("class", "y axis")
            .attr("transform", "translate(0," + 0 + ")")
            //.call(yAxis3)
            .append("text")
            .attr("class", "label")
            .attr("x", 0)
            .attr("y", 150)
            .style("text-anchor", "end")
            .text("Log Likelihood");








        function step1() {

            svg1.selectAll(".input").remove();
            //svg1.selectAll("bar").remove();

            // calculate the number of histogram bins
            if (calcHistBinsAutmoatic == true) {
                numHistBins = Math.ceil(Math.sqrt(input_data.length));  // global variable
            }
            // the histogram function
            histogram = d3.layout.histogram()
                .frequency(false)
                .bins(numHistBins);
            //.bins(x.ticks(500));

            var data = histogram(input_data);

            var delay = 0
            svg1.selectAll("rect")
                .data(input_data)
                .enter().append("rect")
                .attr("class", "input")
                .attr("id", function (d, i) { return "rect" + i; })
                .attr("x", function (d) { return x(d); })
                .attr("y", -5)
                .attr("width", 1)
                .attr("height", 5)
                .attr("opacity", 0)
                .transition()
                .delay(function (d, i) {
                    delay = delay + 2000 / (i + 1);
                    return delay;
                })
                .duration(1000)
                .attr("opacity", 0.5);

        };



        function step2() {
            svg1.append("g")
                .attr("class", "x axis xaxis2")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis)
                .append("text")
                .attr("class", "label")
                .attr("x", width)
                .attr("y", 40)
                .style("text-anchor", "end")
                .text("Total Gross Weight (lbs)");

            var current_y = [];

            histogram_data.forEach(function (d) {
                current_y.push(height);
            });

            console.log("current_y", current_y);
            //var current_y = [height, height, height, height, height, height, height, height, height, height, height, height, height, height, height, height, height, height, height, height];

            for (i = 0; i < histogram_data.length; i++) {
                if (i < 20) {
                    svg1.select("#rect" + i)
                        .transition()
                        .delay(i * 1000)
                        .duration(1000)
                        .attr("width", x(2000) - x(1000) - 1)
                        .attr("x", x(histogram_data[i]))
                        .attr("y", current_y[histogram_data[i] / 50] - 2)
                        .attr("height", 1)
                        .attr("opacity", 0.5);
                } else if (i < 1020) {
                    svg1.select("#rect" + i)
                        .transition()
                        .delay(20000 + (i - 20) * 10)
                        .duration(10)
                        .attr("width", x(2000) - x(1000) - 1)
                        .attr("x", x(histogram_data[i]))
                        .attr("y", function (d) {
                            console.log("histogram_data[i]", histogram_data[i]);
                            console.log("current_y[histogram_data[i] / 50]", current_y[histogram_data[i] / 50]);
                            return current_y[histogram_data[i] / 50] - 2;
                        })
                        .attr("height", 1)
                        .attr("opacity", 0.5);
                } else {
                    svg1.select("#rect" + i)
                        .transition()
                        .delay(20000 + 10000)
                        .duration(0)
                        .attr("width", x(2000) - x(1000) - 1)
                        .attr("x", x(histogram_data[i]))
                        .attr("y", current_y[histogram_data[i] / 50] - 2)
                        .attr("height", 1)
                        .attr("opacity", 0.5);
                }
                

                current_y_i = histogram_data[i] / 50;
                //console.log("histogram_data[i]", histogram_data[i]);

                current_y[current_y_i] = current_y[current_y_i] - 1;
                //console.log("current_y", current_y);
            };
        };



        function histogram_with_kde2_() {
            svg1.selectAll(".kde").remove();
            bandwith = slider.value;
            var kde = kernelDensityEstimator(epanechnikovKernel(bandwith), x.ticks(10000));

            // show the kernel density plot
            if (showKDP == true) {
                svg1.append("path")
                    .datum(kde(input_data))
                    .attr("class", "kde")
                    .attr("fill", "none")
                    .attr("stroke", "#000")
                    .attr("d", line_)
                    .transition().duration(2000)
                    .attr("d", line_kde);
            }

        };

        function histogram_with_kde2() {
            svg1.selectAll(".kde").remove();
            bandwith = slider.value;
            var kde = kernelDensityEstimator(epanechnikovKernel(bandwith), x.ticks(100));

            // show the kernel density plot
            if (showKDP == true) {
                svg1.append("path")
                    .datum(kde(input_data))
                    .attr("class", "kde")
                    .attr("fill", "none")
                    .attr("stroke", "#000")
                    .attr("d", line_kde);
            };
        };




        function step4() {
            d3.selectAll(".group").remove();
            // show the kernel density plot
            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(1000 + (threshold1 - 1000) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "red")
                .text("Empty/Unloaded")
                .attr("opacity", 0)
                .transition().delay(0).duration(1000)
                .attr("opacity", 1);

            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(threshold1 + (threshold2 - threshold1) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "blue")
                .text("Partially Loaded")
                .attr("opacity", 0)
                .transition().delay(1000).duration(1000)
                .attr("opacity", 1);

            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(threshold2 + (100000 - threshold2) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "green")
                .text("Loaded to Weight Limit")
                .attr("opacity", 0)
                .transition().delay(2000).duration(1000)
                .attr("opacity", 1);

            svg1.selectAll(".threshold").remove();
            var drag1 = d3.behavior.drag();
            var drag2 = d3.behavior.drag();

            drag1.origin(Object)
                .on('drag', drag1_);
            drag2.origin(Object)
                .on('drag', drag2_);

            svg1.append("rect")
                .attr("id", "threshold1")
                .attr("class", "threshold")
                .attr("x", x(threshold1))
                .attr("y", 0)
                .attr("width", 5)
                .attr("height", height)
                .call(drag1)
                .attr("opacity", 0)
                .transition().delay(0).duration(2000)
                .attr("opacity", 1);

            svg1.append("rect")
                .attr("id", "threshold2")
                .attr("class", "threshold")
                .attr("x", x(threshold2))
                .attr("y", 0)
                .attr("width", 5)
                .attr("height", height)
                .call(drag2)
                .attr("opacity", 0)
                .transition().delay(2000).duration(2000)
                .attr("opacity", 1);
        };


        var threshold1 = 40000;
        var threshold2 = 70000;
        var threshold1_final = threshold1;
        var threshold2_final = threshold2;
        var dif1 = 5000;
        var dif2 = 5000;


        function drag1_() {
            d3.select("#threshold1").attr("x", parseInt(d3.select("#threshold1").attr('x'), 10) + d3.event.dx);
            threshold1 = x_(parseInt(d3.select("#threshold1").attr('x'), 10) + parseInt(d3.select("#threshold1").attr('width'), 10) / 2);
            step5();
        };

        function drag2_() {
            d3.select("#threshold2").attr("x", parseInt(d3.select("#threshold2").attr('x'), 10) + d3.event.dx);
            threshold2 = x_(parseInt(d3.select("#threshold2").attr('x'), 10) + parseInt(d3.select("#threshold2").attr('width'), 10) / 2);
            step5();
        };

        var max_dif = 10000;
        function step5_() {
            
            svg1.selectAll(".gmm").remove();
            var input_data1 = input_data.filter(d => (d < threshold1));
            var input_data2 = input_data.filter(d => (d >= threshold1) && (d < threshold2));
            var input_data3 = input_data.filter(d => (d >= threshold2));

            var array1 = Random_normal_Dist(d3.mean(input_data1), d3.deviation(input_data1));
            var array2 = Random_normal_Dist(d3.mean(input_data2), d3.deviation(input_data2));
            var array3 = Random_normal_Dist(d3.mean(input_data3), d3.deviation(input_data3));

            var line_gmm = d3.svg.line()
                .x(function (d) { return x(d.q); })
                .y(function (d) { return y(d.p * 600); });

            var line_gmm_ = d3.svg.line()
                .x(function (d) { return x(d.q); })
                .y(function (d) { return y(0); });

            // show the kernel density plot
            svg1.append("path")
                .datum(array1)
                .attr("class", "gmm gmm1")
                .attr("stroke", "red")
                .attr("fill", "#fdae61")
                .attr("opacity", 0.5)
                .attr("d", line_gmm_)
                .transition().duration(2000)
                .attr("d", line_gmm);

            // show the kernel density plot
            svg1.append("path")
                .datum(array2)
                .attr("class", "gmm gmm2")
                .attr("stroke", "blue")
                .attr("fill", "#4393c3")
                .attr("opacity", 0.5)
                .attr("d", line_gmm_)
                .transition().delay(2000).duration(2000)
                .attr("d", line_gmm);

            // show the kernel density plot
            svg1.append("path")
                .datum(array3)
                .attr("class", "gmm gmm3")
                .attr("stroke", "green")
                .attr("fill", "#2ca25f")
                .attr("opacity", 0.5)
                .attr("d", line_gmm_)
                .transition().delay(4000).duration(2000)
                .attr("d", line_gmm);
        };

        var recent_log_sum = [];
        var log_sum_final = -999999;
        var duration_ = 1000;
        function step5() {
            document.getElementById("right").style.visibility = "visible";

            //svg1.selectAll(".gmm").remove();
            var input_data1 = input_data.filter(d => (d < threshold1));
            var input_data2 = input_data.filter(d => (d >= threshold1) && (d < threshold2));
            var input_data3 = input_data.filter(d => (d >= threshold2));
            var log_sum = 0;
            input_data1.forEach(function (d) {
                log_sum = log_sum + Math.log(jStat.normal.pdf(d, d3.mean(input_data1), d3.deviation(input_data1)));
            });

            input_data2.forEach(function (d) {
                log_sum = log_sum + Math.log(jStat.normal.pdf(d, d3.mean(input_data2), d3.deviation(input_data2)));
            });

            input_data3.forEach(function (d) {
                log_sum = log_sum + Math.log(jStat.normal.pdf(d, d3.mean(input_data3), d3.deviation(input_data3)));
            });

            //console.log("log_sum", log_sum, color_logsum(log_sum));
            //console.log(log_sum, log_sum_final, log_sum > log_sum_final)
            var line_mle = d3.svg.line()
                .x(function (d) { return x2(d[0]); })
                .y(function (d) { return y2(d[1]); });
            if (log_sum > log_sum_final) {
                //console.log("log_sum_final", log_sum_final)
                svg2.append("path")
                    .datum([[threshold1_final, threshold2_final],[threshold1, threshold2]])
                    .attr("stroke", "blue")
                    .attr("fill", "none")
                    .attr("opacity", 0.5)
                    .attr("d", line_mle);

                dif1 = Math.max(Math.abs(threshold1 - threshold1_final), max_dif);
                dif2 = Math.max(Math.abs(threshold2 - threshold2_final), max_dif);

                threshold1_final = threshold1;
                threshold2_final = threshold2;
                log_sum_final = log_sum;
                step7();
            }

            if (recent_log_sum.length == 0) {
                for (var i = 0; i < 100; i += 1) {
                    recent_log_sum.push(log_sum);
                };
                //console.log("threshold1", threshold1);
                //console.log("threshold1_final", threshold1_final);
                //console.log("threshold2", threshold2);
                //console.log("threshold2_final", threshold2_final);
                //console.log("init", recent_log_sum);
                update_log_sum_();
            } else {
                for (var i = 0; i < 99; i += 1) {
                    recent_log_sum[i] = recent_log_sum[i + 1];
                    recent_log_sum[99] = log_sum;
                };
                //console.log("update", recent_log_sum);
                update_log_sum();
            };




            svg2.append("circle")
                .attr("stroke", color_logsum(log_sum))
                .attr("r", 1)
                .attr("cx", x2(threshold1))
                .attr("cy", y2(threshold2))
                .attr("fill", "black")
                .transition()
                .duration(2000)
                .attr("fill", color_logsum(log_sum));
            


            var array1 = Random_normal_Dist(d3.mean(input_data1), d3.deviation(input_data1));
            var array2 = Random_normal_Dist(d3.mean(input_data2), d3.deviation(input_data2));
            var array3 = Random_normal_Dist(d3.mean(input_data3), d3.deviation(input_data3));

            var line_gmm = d3.svg.line()
                .x(function (d) { return x(d.q); })
                .y(function (d) { return y(d.p * 600); });


            // show the kernel density plot
            svg1.selectAll(".gmm1")
                .datum(array1)
                //.transition().duration(duration_)
                .attr("d", line_gmm);

            svg1.selectAll(".gmm2")
                .datum(array2)
                //.transition().duration(duration_)
                .attr("d", line_gmm);

            svg1.selectAll(".gmm3")
                .datum(array3)
                //.transition().duration(duration_)
                .attr("d", line_gmm);

            d3.selectAll(".group").remove();
            // show the kernel density plot
            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(300 + (threshold1 - 300) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "red")
                .text("Empty/Unloaded");

            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(threshold1 + (threshold2 - threshold1) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "blue")
                .text("Partially Loaded");

            svg1.append("text")
                .attr("class", "group")
                .attr("x", x(threshold2 + (100000 - threshold2) / 2))
                .attr("y", 0)
                .attr("text-anchor", "middle")
                .attr("fill", "green")
                .text("Loaded to Weight Limit");
        };

        var step6_ind = 0;

        function step6() {
            step6_ind = 0;
            duration_ = 0;
            step6_();
            duration_ = 1000;
            setTimeout(step7, 100);
            max_dif = max_dif / 2;
        };

        function step6_() {
            if (step6_ind <= 100) {
                step6_ind = step6_ind + 1;
                threshold1 = Math.min(Math.floor(Math.random() * dif1 * 2) + threshold1_final - dif1, 50000);
                threshold2 = Math.max(Math.floor(Math.random() * dif2 * 2) + threshold2_final - dif2, 50000);
                //console.log("threshold1_6", threshold1);
                //console.log("threshold2_6", threshold2);
                d3.select("#threshold1").attr("x", x(threshold1));
                d3.select("#threshold2").attr("x", x(threshold2));
                step5();
                if (step6_ind <= 100) {
                    setTimeout(step6_, 100);
                } else {
                    setTimeout(step6_, 10);
                };
            };
        };

        function step7() {
            //threshold1_final = 450;
            //threshold2_final = 750;
            //step5();
            threshold1 = threshold1_final;
            threshold2 = threshold2_final;

            step5();
            d3.select("#threshold1").attr("x", x(threshold1_final));
            d3.select("#threshold2").attr("x", x(threshold2_final));
            

            d3.selectAll(".final").remove();
            svg2.append("circle")
                .attr("class", "final")
                .attr("stroke", "red")
                .attr("fill", "red")
                .attr("r", 10)
                .attr("cx", x2(threshold1_final))
                .attr("cy", y2(threshold2_final));

            svg2.append("text")
                .attr("class", "final")
                .attr("x", x2(threshold1_final))
                .attr("y", y2(threshold2_final) - 10)
                .attr("text-anchor", "middle")
                .attr("font-weight", 800)
                .attr("font-size", 14)
                .text("MLE");

        };



        function update_log_sum_() {
            // show the kernel density plot
            svg3.append("path")
                .datum(recent_log_sum)
                .attr("class", "log_sum")
                .attr("stroke", "blue")
                .attr("fill", "none")
                .attr("opacity", 0.5)
                .attr("d", line_log_sum_)
                .transition().duration(10)
                .attr("d", line_log_sum);
        }

        function update_log_sum() {
            d3.selectAll(".log_sum").remove();
            // show the kernel density plot
            svg3.append("path")
                .datum(recent_log_sum)
                .attr("class", "log_sum")
                .attr("stroke", "blue")
                .attr("fill", "none")
                .attr("opacity", 0.5)
                .attr("d", line_log_sum);

            //// show the kernel density plot
            //svg3.selectAll(".log_sum")
            //    .datum(recent_log_sum)
            //    .transition().duration(1000)
            //    .attr("d", line_log_sum);
        }


        function Random_normal_Dist(mean, sd) {
            data = [];
            min = mean - 4 * sd;
            max = mean + 4 * sd;
            bin = (max - min) / 1000;
            for (var i = 0; i < 1001; i += 1) {
                q = min + i * bin
                p = jStat.normal.pdf(q, mean, sd);
                arr = {
                    "q": q,
                    "p": p
                }
                data.push(arr);
            };
            return data;
        }



        // the histogram function
        //var histogram;


        //var svg = d3.select("body").append("svg")
        //    .attr("width", width + margin.left + margin.right)
        //    .attr("height", height + margin.top + margin.bottom)
        //    .append("g")
        //    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        //// draw the background
        //svg.append("g")
        //    .attr("class", "x axis")
        //    .attr("transform", "translate(0," + height + ")")
        //    .call(xAxis)
        //    .append("text")
        //    .attr("class", "label")
        //    .attr("x", width)
        //    .attr("y", -6)
        //    .style("text-anchor", "end")
        //    .text("Time between Eruptions (min.)");

        //svg.append("g")
        //    .attr("class", "y axis")
        //    .call(yAxis);




        //function histogram_with_kde(faithful) {

        //    svg.selectAll("path").remove();
        //    svg.selectAll("bar").remove();
        //    bandwith = slider.value;
        //    console.log("histogram_with_kde", bandwith);

        //    // calculate the number of histogram bins
        //    if (calcHistBinsAutmoatic == true) {
        //        numHistBins = Math.ceil(Math.sqrt(faithful.length));  // global variable
        //    }
        //    // the histogram function
        //    histogram = d3.layout.histogram()
        //        .frequency(false)
        //        .bins(numHistBins);
        //    //.bins(x.ticks(500));

        //    var data = histogram(faithful);
        //    //var kde = kernelDensityEstimator(epanechnikovKernel(7), x.ticks(100));
        //    var kde = kernelDensityEstimator(epanechnikovKernel(bandwith), x.ticks(100));

        //    //alert("kde is " + kde.toSource());

        //    //console.log(svg.datum(kde(faithful)));

        //    svg.selectAll(".bar")
        //        .data(data)
        //        .enter().insert("rect", ".axis")
        //        .attr("class", "bar")
        //        .attr("x", function (d) { return x(d.x) + 1; })
        //        .attr("y", function (d) { return y(d.y); })
        //        .attr("width", x(data[0].dx + data[0].x) - x(data[0].x) - 1)
        //        .attr("height", function (d) { return height - y(d.y); });

        //    // show the kernel density plot
        //    if (showKDP == true) {
        //        svg.append("path")
        //            .datum(kde(faithful))
        //            .attr("class", "line")
        //            .attr("d", line);
        //    }

        //};

        function kernelDensityEstimator(kernel, x) {
            return function (sample) {
                return x.map(function (x) {
                    //console.log(x + " ... " + d3.mean(sample, function(v) { return kernel(x - v); }));
                    return [x, d3.mean(sample, function (v) { return kernel(x - v); })];
                });
            };
        }

        function epanechnikovKernel(bandwith) {
            return function (u) {
                //return Math.abs(u /= bandwith) <= 1 ? .75 * (1 - u * u) / bandwith : 0;
                if (Math.abs(u = u / bandwith) <= 1) {
                    return 0.75 * (1 - u * u) / bandwith;
                } else return 0;
            };
        }
    </script>

    <script>
        var slider = document.getElementById("myRange");
        var output = document.getElementById("demo");
        //var myIndex;
        //output.innerHTML = slider.value;

        //function butto_animation_click() {
        //    console.log("butto_animation_click");
        //    myIndex = 0;
        //    test();
        //}

        function step3() {
            d3.selectAll(".xaxis1").remove();
            var slider = document.getElementById("div_slider");
            slider.style.visibility = "visible";
            //output.innerHTML = 50;
            histogram_with_kde2_();
        }


        //function test() {
        //    if (myIndex <= 99) {
        //        myIndex = myIndex + 1;
        //        slider.value = myIndex;
        //        output.innerHTML = slider.value;
        //        histogram_with_kde(input_data);
        //        setTimeout(test, 500);
        //    };
        //}

        slider.oninput = function () {
            //myIndex = 999;
            //output.innerHTML = this.value;
            histogram_with_kde2();
        }
    </script>


    <script>
        function addTable() {
            var x = document.createElement("TABLE");
            x.setAttribute("id", "myTable");
            document.body.appendChild(x);

            var y = document.createElement("TR");
            y.setAttribute("id", "myTr");
            document.getElementById("myTable").appendChild(y);

            var z = document.createElement("TD");
            var t = document.createTextNode("cell");
            z.appendChild(t);
            document.getElementById("myTr").appendChild(z);
            document.getElementById("myTr").appendChild(z);
            document.getElementById("myTr").appendChild(z);
        }

        addTable();
    </script>
